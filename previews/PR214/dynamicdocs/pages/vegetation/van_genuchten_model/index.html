<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Van Genuchten model · ClimaLSM.jl</title><script data-outdated-warner src="../../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../../">ClimaLSM.jl</a></span></div><form class="docs-search" action="../../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">ClimaLSM</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/ClimaLSM/">ClimaLSM</a></li><li><a class="tocitem" href="../../../../APIs/Regridder/">Parameter Dataset Tools</a></li><li><a class="tocitem" href="../../../../APIs/shared_utilities/">Shared Utilities</a></li><li><input class="collapse-toggle" id="menuitem-2-1-4" type="checkbox"/><label class="tocitem" for="menuitem-2-1-4"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/Soil/">Soil Energy and Hydrology</a></li><li><a class="tocitem" href="../../../../APIs/SoilBiogeochemistry/">Soil Biogeochemistry</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-1-5" type="checkbox"/><label class="tocitem" for="menuitem-2-1-5"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/canopy/Canopy/">Canopy Models</a></li><li><a class="tocitem" href="../../../../APIs/canopy/PlantHydraulics/">Plant Hydraulics</a></li><li><a class="tocitem" href="../../../../APIs/canopy/Photosynthesis/">Canopy Photosynthesis</a></li><li><a class="tocitem" href="../../../../APIs/canopy/RadiativeTransfer/">Canopy RT</a></li><li><a class="tocitem" href="../../../../APIs/canopy/StomatalConductance/">Canopy Stomatal Conductance</a></li></ul></li><li><a class="tocitem" href="../../../../APIs/SurfaceWater/">Surface Water Models</a></li><li><a class="tocitem" href="../../../../APIs/Bucket/">Bucket Model</a></li><li><a class="tocitem" href="../../../../APIs/Snow/">Snow Model</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../../Contributing/">Contribution guide</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">For model developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/Usage/LSM_single_column_tutorial/">Intro to multi-component models</a></li><li><a class="tocitem" href="../../../../generated/Usage/domain_tutorial/">Intro to ClimaLSM Domains</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Running simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-2-1" type="checkbox"/><label class="tocitem" for="menuitem-4-2-1"><span class="docs-label">Soil modeling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/Soil/richards_equation/">Richards Equation</a></li><li><a class="tocitem" href="../../../../generated/Soil/soil_energy_hydrology/">Energy and Hydrology</a></li><li><a class="tocitem" href="../../../../generated/Soil/freezing_front/">Phase Changes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2-2"><span class="docs-label">Canopy modeling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/Canopy/canopy_tutorial/">Standalone Canopy</a></li><li><a class="tocitem" href="../../../../generated/Canopy/soil_canopy_tutorial/">Coupled Canopy and Soil</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2-3" type="checkbox"/><label class="tocitem" for="menuitem-4-2-3"><span class="docs-label">Bucket LSM</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/Bucket/bucket_tutorial/">Introduction to the Land Bucket Model</a></li><li><a class="tocitem" href="../../../../generated/Bucket/coupled_bucket/">Setting up a Coupled Simulation</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">DynamicDocs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox" checked/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Vegetation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-1-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1-1"><span class="docs-label">Radiative transfer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../beer_model/">Beer model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-1-2" type="checkbox"/><label class="tocitem" for="menuitem-5-1-2"><span class="docs-label">Photosynthesis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../farquhar_model/">Farquhar model</a></li><li><a class="tocitem" href="../optimality_model/">Optimality model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-1-3" type="checkbox"/><label class="tocitem" for="menuitem-5-1-3"><span class="docs-label">Stomatal conductance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../medlyn_model/">Medlyn model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-1-4" type="checkbox" checked/><label class="tocitem" for="menuitem-5-1-4"><span class="docs-label">Plant hydraulics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Van Genuchten model</a><ul class="internal"><li><a class="tocitem" href="#Van-Genuchten-Model"><span>Van Genuchten Model</span></a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Soil biogeochemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../soil_biogeochemistry/microbial_respiration/">Microbial respiration</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../../folderstructure/">Repository structure</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">DynamicDocs</a></li><li><a class="is-disabled">Vegetation</a></li><li><a class="is-disabled">Plant hydraulics</a></li><li class="is-active"><a href>Van Genuchten model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Van Genuchten model</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimaLSM.jl/blob/main/docs/src/dynamicdocs/pages/vegetation/van_genuchten_model.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Plant-Hydraulics"><a class="docs-heading-anchor" href="#Plant-Hydraulics">Plant Hydraulics</a><a id="Plant-Hydraulics-1"></a><a class="docs-heading-anchor-permalink" href="#Plant-Hydraulics" title="Permalink"></a></h1><p>Additional understanding of stomatal behavior comes from the transport of water through the soil-plant–atmosphere continuum. Plants reduce stomatal conductance as needed to regulate transpiration and prevent desiccation or other hydraulic failure.</p><p>Specifically, water loss during day-time transpiration drives plants to draw water from the soil by roots and transport it through the stem to leaves. Transpiration provides the force that pulls water from soil. As transpiration is dominant during the day, water in soil near the roots, water in the stem, and water in foliage create a water potential gradient that allows leaves to draw water from the soil.</p><p>The plant hydraulics code solves for the volumetric water content in the stem and leaf (<span>$\theta_{stem}$</span> and <span>$\ theta_{leaf}$</span>). It allows for an arbitrary number of stem/leaf compartments, but for now we will start with a single stem and leaf compartment. </p><h2 id="Van-Genuchten-Model"><a class="docs-heading-anchor" href="#Van-Genuchten-Model">Van Genuchten Model</a><a id="Van-Genuchten-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Van-Genuchten-Model" title="Permalink"></a></h2><p>As explained above, soil moisture is an indispensable variable in studying plant water uptake. Van Genuchten (1980) developed a widely used soil moisture retention curve, which is used below to describe plant hydraulics.</p><p>The volume flux of water <span>$q$</span> (m/s) between compartments with centers at two heights, <span>$z_1$</span> and <span>$z_2$</span>, is given by Darcy&#39;s law as</p><p class="math-container">\[\begin{align}
    q = -\int_{z_1}^{z_2} k(\psi) dh
\end{align}\]</p><p>where <span>$h = \psi+z$</span> is the head (in meters), and <span>$k$</span> is the conductance (units of 1/s). As this is the conductance unit that CLM uses, there should be data bases with this information. We approximate this using finite difference as\footnote{Double check this - the units of <span>$k$</span> in our code are <span>$m/s$</span>.}</p><p class="math-container">\[\begin{equation}
q = -\int_{h_1}^{h_2} k(\psi) dh \approx -\frac{k_1(\psi_1) + k_2(\psi_2)}{2} * [(\psi_2 - \psi_1) + (z_2 - z_1)].
\end{equation}\]</p><p>In order to close the set of equations, the user will have to specify <span>$k(\psi)$</span> and a function <span>$\psi(\theta)$</span>. In our current implementation, we use a van Genuchten relationship with the same parameters for all compartments, but differing values of <span>$K_{sat}.$</span></p><p>The change of water volume (m<span>$^3),  V$</span>, in the compartments is then</p><p class="math-container">\[\begin{align}
    \frac{d V_{w, stem}}{dt} = q_{roots}\sigma_{roots} - q_{stem}\sigma_{stem} \nonumber \\
    \frac{d V_{w, leaf}}{dt} = q_{stem}\sigma_{stem} - \tau \sigma_{leaf},
\end{align}\]</p><p>where <span>$\tau$</span> is a transpiration volume flux per unit emitting area, and <span>$\sigma$</span> is the total emitting/conducting area\footnote{Note that these are actually the areas at the faces between compartments. In the code, we take the average of the cross section of the compartments to estimate this.}. </p><p>This currently holds for a single plant. To convert to fluxes from an entire surface, we can multiply by the number of individuals <span>$N$</span>. We can make use of the fact that <span>$N\sigma/A$</span>, where <span>$A$</span> is the area of the ground those <span>$N$</span> individuals are occupying, is the area index for that plant type. Following CLM, we incorporate a root, stem, and leaf area index (RAI, SAI, LAI) in order to model fluxes across an entire grid cell. </p><p>Then we have:</p><p class="math-container">\[\begin{align}
    \frac{d v_{stem}}{dt} = q_{roots}RAI - q_{stem}SAI \nonumber \\
    \frac{d v_{leaf}}{dt} = q_{stem}SAI - \tau LAI,
\end{align}\]</p><p>where <span>$v$</span> now represents the volume of water in that compartment (of a bulk plant) per unit ground area.</p><p>We also need to convert from the variable <span>$v$</span> to <span>$\psi$</span>, in order to compute root extraction with the soil.  To do so, we can convert <span>$v$</span> to the volumetric water content, and from <span>$\theta$</span> to <span>$\psi$</span> using a van Genuchten relationship. To convert, let the volume of water per area of compartment be <span>$V_{w,stem}$</span>, and <span>$H$</span> the typical ``length&quot; of the compartment. Then</p><p class="math-container">\[\begin{equation}
    \theta_{stem}=\frac{V_{w,stem}}{A_{ground}} \times \frac{A_{ground}}{A_{stem}} \times \frac{1}{H_{stem}} = \frac{v_{stem}}{H_{stem} \times SAI }.
\end{equation}\]</p><p>Substituting in the volumetric water content, we have</p><p class="math-container">\[\begin{align}
    \frac{d \theta_{stem}}{dt} &amp;= \frac{q_{roots}RAI - q_{stem}SAI}{H_{stem} SAI} \nonumber \\
    \frac{d \theta_{leaf}}{dt} &amp;= \frac{q_{stem}SAI - \tau LAI}{H_{leaf} LAI},
\end{align}\]</p><p>We can also account for the distribution of roots as a function of depth. A quantity that is modeled in plant hydraulic models is the root fraction <span>$P(z)$</span>, satisfying <span>$\int P(z) dz = 1$</span>. Instead of having a single root at one discrete location, we can distribute the root system over different depths using <span>$P(z)$</span>. The total flux from roots between <span>$z$</span> and <span>$z+dz$</span> is given by</p><p class="math-container">\[\begin{equation}
    dq_{roots}(z) = -P(z) dz \int_{h_{soil}(z)}^{h_{stem}} k(\psi) dh,
\end{equation}\]</p><p>so that the net flux for the plant system would sum over this</p><p class="math-container">\[\begin{equation}
    q_{roots}  = -\int_{z_{min}}^{z_{sfc}} \frac{dq_{roots}(z)}{dz}dz ,
\end{equation}\]</p><p>where <span>$z_{min}$</span> is the minimum soil layer of the simulation. </p><p>The sink term of the soil is in terms of a volumetric fraction change, i.e. we need a volume of water per volume of soil per second. We can obtain this with</p><p class="math-container">\[\begin{equation}
    S(z) = -(RAI) dq_{roots}(z)/dz = (RAI) P(z) \int_{h_{soil}(z)}^{h_{stem}} k(\psi) dh.
\end{equation}\]</p><p>The sign change occurs in the expression for <span>$S(z)$</span> because a positive value of <span>$q_{roots}$</span> indicates flow from the soil to the plant. This is a sink term for the soil.</p><p>The model needs the following parameters:</p><table><tr><th style="text-align: left">Drivers</th><th style="text-align: center">Symbol</th><th style="text-align: center">Unit</th><th style="text-align: center">Range</th></tr><tr><td style="text-align: left">A function of simulation time t given the leaf area index</td><td style="text-align: center">LAI</td><td style="text-align: center">m²/m²</td><td style="text-align: center">NEED INFO</td></tr><tr><td style="text-align: left">The constant stem area index</td><td style="text-align: center">SAI</td><td style="text-align: center">m²/m²</td><td style="text-align: center">NEED INFO</td></tr><tr><td style="text-align: left">The constant root area index</td><td style="text-align: center">RAI</td><td style="text-align: center">m²/m²</td><td style="text-align: center">NEED INFO</td></tr></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../medlyn_model/">« Medlyn model</a><a class="docs-footer-nextpage" href="../../soil_biogeochemistry/microbial_respiration/">Microbial respiration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 13 September 2023 19:43">Wednesday 13 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
